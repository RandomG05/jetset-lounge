/**
 * Filename: billing.reportSalesProfitByMenu.js
 * Generated 2020-08-17 at 08:28:03 AM
 */
Ext.define('ExtApp.modules.billing.model.model_dataShift',{extend:'Ext.data.Model',alias:'model_dataShift',fields:[{name:'id',type:'int'},{name:'nama_shift',type:'string'},{name:'jam_shift_start',type:'string'},{name:'jam_shift_end',type:'string'},{name:'created',type:'string'},{name:'createdby',type:'string'},{name:'updated',type:'string'},{name:'updatedby',type:'string'}],proxy:{type:'ajax',url:appUrl+'billing/dataShift/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.systems.model.model_UserData',{extend:'Ext.data.Model',alias:'model_UserData',fields:[{name:'id',type:'int'},{name:'user_username',type:'string'},{name:'user_pin',type:'string'},{name:'client_id',type:'int'},{name:'client_name',type:'string'},{name:'client_structure_id',type:'int'},{name:'client_structure_name',type:'string'},{name:'role_id',type:'int'},{name:'role_name',type:'string'},{name:'user_fullname',type:'string'},{name:'user_firstname',type:'string'},{name:'user_lastname',type:'string'},{name:'user_email',type:'string'},{name:'user_phone',type:'string'},{name:'user_mobile',type:'string'},{name:'user_address',type:'string'},{name:'avatar',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'window_mode',type:'string'}],proxy:{type:'ajax',url:appUrl+'systems/UserData/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.billing.store.store_dataShift',{extend:'Ext.data.Store',model:'ExtApp.modules.billing.model.model_dataShift',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.billing.store.store_sortReport',{extend:'Ext.data.Store',fields:[{name:'val',type:'string'},{name:'name',type:'string'},{name:'sort',type:'string'}],proxy:{type:'ajax',url:appUrl+'billing/sortReport/sortData',actionMethods:{read:'POST'},reader:{type:'json'}},autoLoad:false});Ext.define('ExtApp.modules.billing.store.store_tipeSalesReport',{extend:'Ext.data.Store',fields:['val','name'],data:[{"val":"all_sales","name":"Semua Sales"},{"val":"sales_no_discount","name":"Sales - Tanpa Diskon"},{"val":"sales_only_discount","name":"Sales - Semua Diskon"},{"val":"sales_no_compliment","name":"Sales - Tanpa Compliment"},{"val":"sales_only_compliment","name":"Sales - Semua Compliment"},{"val":"sales_no_customer","name":"Sales - Tanpa Customer"},{"val":"sales_only_customer","name":"Sales - Semua Customer"},{"val":"sales_no_marketing","name":"Sales - Tanpa Marketing/Sales-Fee"},{"val":"sales_only_marketing","name":"Sales - Semua Marketing/Sales-Fee"},{"val":"sales_only_dinein","name":"Sales - Semua Dine-in"},{"val":"sales_only_takeaway","name":"Sales - Semua Takeaway"},{"val":"sales_only_delivery","name":"Sales - Semua Delivery"},],autoLoad:false});Ext.define('ExtApp.modules.billing.store.store_tipeLaporanReportMenu',{extend:'Ext.data.Store',fields:['val','name'],data:[{"val":"menu","name":"Menu"},{"val":"menu_hpp","name":"Menu HPP"},{"val":"varian","name":"Varian"},{"val":"tax_service","name":"Tax & Service"},{"val":"package","name":"Package"},{"val":"floorplan","name":"Tipe/Lantai"},],autoLoad:false});Ext.define('ExtApp.modules.systems.store.store_UserData',{extend:'Ext.data.Store',model:'ExtApp.modules.systems.model.model_UserData',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.billing.view.reportSalesProfitByMenu",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var v_this=this;var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');me.store_ComboboxSortReport_reportSalesProfitByMenu=theApp.getStore('store_ComboboxSortReport_reportSalesProfitByMenu',false);if(me.store_ComboboxSortReport_reportSalesProfitByMenu==false){me.store_ComboboxSortReport_reportSalesProfitByMenu=theApp.copyStore('billing','store_sortReport','store_ComboboxSortReport_reportSalesProfitByMenu');}
me.store_ComboboxSortReport_reportSalesProfitByMenu.proxy.extraParams.tipe='menu_profit';me.store_ComboboxSortReport_reportSalesProfitByMenu.proxy.extraParams.recap=0;var store_ComboboxTipeSales_reportSalesProfitByMenu=theApp.getStore('store_ComboboxTipeSales_reportSalesProfitByMenu',false);if(store_ComboboxTipeSales_reportSalesProfitByMenu==false){store_ComboboxTipeSales_reportSalesProfitByMenu=theApp.copyStore('billing','store_tipeSalesReport','store_ComboboxTipeSales_reportSalesProfitByMenu');}
var store_ComboboxTipeLaporan_reportSalesProfitByMenu=theApp.getStore('store_ComboboxTipeLaporan_reportSalesProfitByMenu',false);if(store_ComboboxTipeLaporan_reportSalesProfitByMenu==false){store_ComboboxTipeLaporan_reportSalesProfitByMenu=theApp.copyStore('billing','store_tipeLaporanReportMenu','store_ComboboxTipeLaporan_reportSalesProfitByMenu');}
me.store_ComboboxKasir_reportSalesProfitByMenu=theApp.getStore('store_UserData',false);if(me.store_ComboboxKasir_reportSalesProfitByMenu==false){me.store_ComboboxKasir_reportSalesProfitByMenu=theApp.copyStore('systems','store_UserData','store_ComboboxKasir_reportSalesProfitByMenu');}
me.store_ComboboxKasir_reportSalesProfitByMenu.proxy.extraParams.role_id=opt_role_id_kasir;me.store_ComboboxKasir_reportSalesProfitByMenu.proxy.extraParams.limit=999999;me.store_ComboboxKasir_reportSalesProfitByMenu.proxy.extraParams.show_all_text=1;me.store_ComboboxKasir_reportSalesProfitByMenu.proxy.extraParams.show_choose_text=0;me.store_ComboboxKasir_reportSalesProfitByMenu.proxy.extraParams.is_dropdown=1;me.store_ComboboxKasir_reportSalesProfitByMenu.proxy.extraParams.keywords='';me.store_dataShift_reportSalesProfitByMenu=theApp.getStore('store_dataShift_reportSalesProfitByMenu',false);if(me.store_dataShift_reportSalesProfitByMenu==false){me.store_dataShift_reportSalesProfitByMenu=theApp.copyStore('billing','store_dataShift','store_dataShift_reportSalesProfitByMenu');}
me.store_dataShift_reportSalesProfitByMenu.proxy.extraParams.limit=9999999;me.store_dataShift_reportSalesProfitByMenu.proxy.extraParams.show_all_text=1;me.store_dataShift_reportSalesProfitByMenu.proxy.extraParams.show_choose_text=0;me.store_dataShift_reportSalesProfitByMenu.proxy.extraParams.is_dropdown=1;me.store_dataShift_reportSalesProfitByMenu.proxy.extraParams.product_type='';me.store_dataShift_reportSalesProfitByMenu.proxy.extraParams.keywords='';var add_parameter='_dc='+phpJs.mktime();add_parameter+='&useview=print_reportSalesProfitByMenu';add_parameter+='&date_from='+phpJs.date("d-m-Y");add_parameter+='&date_till='+phpJs.date("d-m-Y");add_parameter+='&shift_billing=0';add_parameter+='&sorting=';add_parameter+='&show_payment=true';add_parameter+='&show_compliment=true';add_parameter+='&show_tax=true';add_parameter+='&show_service=true';add_parameter+='&format_nominal=true';add_parameter+='&breakdown_package=false';add_parameter+='&tipe_laporan=menu';var url_report=appUrl+'billing/reportSalesByMenu/print_reportSalesByMenu?'+add_parameter;var hiddenFtr=true;return desktop.createWindow({id:me.id,title:'Sales Profit By Menu',width:880,height:600,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,border:0,layout:{type:'border'},items:[{xtype:'form',title:'Filter Pencarian',width:280,region:'west',id:'form_filter_reportSalesProfitByMenu',split:true,collapsible:true,splitterResize:false,collapseMode:'mini',animCollapse:true,scroll:false,bodyPadding:'5 10 5 10',margin:'0 0 0 0',items:[{xtype:'displayfield',fieldLabel:'',value:'<font style="color:gray; font-weight:bold;">Tipe Laporan:</font>',margin:'0 0 0 0',hidden:hiddenFtr},{xtype:'combobox',name:'tipe_sales',id:'src_tipe_laporan_reportSalesProfitByMenu',fieldLabel:'',labelSeparator:'',width:250,labelWidth:0,emptyText:'Menu',store:store_ComboboxTipeLaporan_reportSalesProfitByMenu,queryMode:'local',displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,pageSize:0,margin:'0 0 5 0',hidden:hiddenFtr},{xtype:'displayfield',fieldLabel:'',value:'<font style="color:gray; font-weight:bold;">Tanggal Transaksi:</font>'},{xtype:'container',border:0,layout:{type:'column'},margin:'0 0 0 5',items:[{xtype:'datefield',fieldLabel:'',name:'date_from',id:'src_dateFrom_reportSalesProfitByMenu',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'0 0 0 0',labelWidth:0,width:105,value:phpJs.date('d-m-Y'),allowBlank:false},{xtype:'datefield',fieldLabel:' s/d ',name:'date_till',id:'src_dateTill_reportSalesProfitByMenu',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'0 0 0 10',labelWidth:20,width:130,value:phpJs.date('d-m-Y'),allowBlank:false}]},{xtype:'hidden',name:'srcSortReportDESC',id:'srcSortReportDESC_reportSalesProfitByMenu'},{xtype:'combobox',name:'srcSortReport',id:'srcSortReport_reportSalesProfitByMenu',fieldLabel:'Urutkan',emptyText:'Nama Menu (A-Z)',width:250,labelWidth:50,store:me.store_ComboboxSortReport_reportSalesProfitByMenu,displayField:'name',valueField:'val',queryMode:'local',margin:'5 0 0 0',hidden:hiddenFtr,listeners:{select:function(combo,records,eOpts){Ext.getCmp('srcSortReport_reportSalesProfitByMenu').setValue(records[0].data.val);Ext.getCmp('srcSortReportDESC_reportSalesProfitByMenu').setValue(records[0].data.sort);}}},{xtype:'combobox',name:'shift_billing',id:'src_shift_billing_reportSalesProfitByMenu',fieldLabel:'Shift',labelSeparator:'',width:250,labelWidth:50,emptyText:'Semua Shift',store:me.store_dataShift_reportSalesProfitByMenu,queryMode:'local',hiddenName:"id",displayField:'nama_shift',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,pageSize:0,margin:'5 0 0 0',hidden:hiddenFtr},{xtype:'combobox',name:'kasir_billing',id:'src_kasir_billing_reportSalesProfitByMenu',fieldLabel:'Kasir',labelSeparator:'',width:250,labelWidth:50,emptyText:'Semua Kasir',store:me.store_ComboboxKasir_reportSalesProfitByMenu,queryMode:'local',hiddenName:"user_username",displayField:'user_fullname',valueField:'user_username',typeAhead:true,minChars:1,forceSelection:true,pageSize:0,margin:'5 0 0 0',hidden:hiddenFtr},{xtype:'displayfield',fieldLabel:'',value:'<font style="color:gray; font-weight:bold;">Tipe Sales/Penjualan:</font>',margin:'5 0 0 0',hidden:hiddenFtr},{xtype:'combobox',name:'tipe_sales',id:'src_tipe_sales_reportSalesProfitByMenu',fieldLabel:'',labelSeparator:'',width:250,labelWidth:0,emptyText:'Semua Sales',store:store_ComboboxTipeSales_reportSalesProfitByMenu,queryMode:'local',displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,pageSize:0,margin:'0 0 0 0',hidden:hiddenFtr},{xtype:'displayfield',fieldLabel:'',value:'<font style="color:gray; font-weight:bold;">Tampilkan Kolom:</font>',margin:'5 0 0 0'},{xtype:'container',border:0,layout:{type:'column'},margin:'0 0 0 10',hidden:true,items:[{xtype:'checkbox',name:'show_payment',id:'show_payment_reportSalesProfitByMenu',fieldLabel:'Payment',inputValue:1,uncheckedValue:0,labelWidth:80,width:120},{xtype:'checkbox',name:'show_tax',id:'show_tax_reportSalesProfitByMenu',fieldLabel:'Tax',inputValue:1,uncheckedValue:0,labelWidth:60,width:100},]},{xtype:'container',border:0,layout:{type:'column'},margin:'0 0 0 10',items:[{xtype:'checkbox',name:'show_compliment',id:'show_compliment_reportSalesProfitByMenu',fieldLabel:'Compliment',inputValue:1,uncheckedValue:0,labelWidth:80,width:120},{xtype:'checkbox',name:'show_service',id:'show_service_reportSalesProfitByMenu',fieldLabel:'Service',inputValue:1,uncheckedValue:0,labelWidth:60,width:100,hidden:true,},]},{xtype:'displayfield',fieldLabel:'',value:'<font style="color:gray; font-weight:bold;">Fitur Khusus:</font>',margin:'5 0 0 0',hidden:hiddenFtr},{xtype:'checkbox',name:'breakdown_package',id:'breakdown_package_reportSalesProfitByMenu',fieldLabel:'Breakdown Package',inputValue:1,uncheckedValue:0,margin:'0 0 0 10',hidden:hiddenFtr,labelWidth:130},{xtype:'checkbox',name:'format_nominal',id:'format_nominal_reportSalesProfitByMenu',fieldLabel:'Format Nominal',inputValue:1,uncheckedValue:0,margin:'0 0 0 10',hidden:hiddenFtr,labelWidth:130},{xtype:'container',style:'text-align:right',border:0,items:[{xtype:'button',text:'Cari',scale:'medium',margin:'15 0 0 0',id:'btnSearch_reportSalesProfitByMenu',tooltip:'Cari',iconCls:'btn-search',width:90,handler:function(){me.print_reportSalesProfitByMenu(0);}},{xtype:'button',text:'Reset',scale:'medium',margin:'15 40 0 10',id:'btnReset_reportSalesProfitByMenu',tooltip:'Reset',iconCls:'btn-reset',width:90,handler:function(){me.print_reportSalesProfitByMenu(-1);}}]},{xtype:'container',style:'text-align:right',border:0,items:[{xtype:'button',text:'Print',scale:'medium',margin:'10 0 0 0',id:'btnPrint_reportSalesProfitByMenu',tooltip:'Print',iconCls:'btn-print',width:90,handler:function(){me.print_reportSalesProfitByMenu(1);}},{xtype:'button',text:'Export',scale:'medium',margin:'10 40 0 10',id:'btnExcel_reportSalesProfitByMenu',tooltip:'Export ke Excel',iconCls:'btn-excel',width:90,handler:function(){me.print_reportSalesProfitByMenu(2);}}]}]},{xtype:"panel",layout:'fit',region:'center',width:600,height:500,border:false,items:[{xtype:"component",id:'print_area_reportSalesProfitByMenu',autoEl:{tag:"iframe",src:url_report},border:false}]}],listeners:{show:function(){Ext.getCmp('show_payment_reportSalesProfitByMenu').setValue(1);Ext.getCmp('show_compliment_reportSalesProfitByMenu').setValue(1);Ext.getCmp('show_tax_reportSalesProfitByMenu').setValue(1);Ext.getCmp('show_service_reportSalesProfitByMenu').setValue(1);Ext.getCmp('format_nominal_reportSalesProfitByMenu').setValue(1);Ext.getCmp('breakdown_package_reportSalesProfitByMenu').setValue(0);me.store_ComboboxSortReport_reportSalesProfitByMenu.load();me.store_ComboboxKasir_reportSalesProfitByMenu.load();me.store_dataShift_reportSalesProfitByMenu.load();this.maximize();}}});}});